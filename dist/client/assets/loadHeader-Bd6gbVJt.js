(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function c(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?a.credentials="include":e.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(e){if(e.ep)return;e.ep=!0;const a=c(e);fetch(e.href,a)}})();function v(n,s,c){if(!n)return"hsl(0, 0%, 80%)";let o=0;for(let a=0;a<n.length;a++)o=n.charCodeAt(a)+((o<<5)-o);return`hsl(${o%360}, ${s}%, ${c}%)`}function S(n){if(!n)return"#eee";const s=v(n,80,75),c=v(n.split("").reverse().join(""),90,70),o=v(n+"-v2",70,80);return`linear-gradient(135deg, ${s}, ${c}, ${o})`}function C(n){return!n||!n.userId?`<span class="player-badge" style="background: #eee; color: #333;">${n.name||"N/A"}</span>`:`<span class="player-badge" style="background: ${S(n.publicId)};">#${n.userId}</span>`}window.stringToHslColor=v;window.generateGradient=S;window.renderPlayerBadge=C;async function O(){try{const n=await fetch("/api/check-auth-status");return n.ok?await n.json():{loggedIn:!1}}catch(n){return console.error("Error checking login status:",n),{loggedIn:!1}}}document.addEventListener("DOMContentLoaded",async()=>{const n=document.getElementById("header-placeholder");if(n)try{const s=await fetch("/components/header.html");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const c=await s.text();n.innerHTML=c;const o=document.getElementById("subheader-placeholder");if(o)try{const t=await fetch("/components/subheader.html");t.ok&&(o.innerHTML=await t.text())}catch(t){console.error("Failed to load sub-header:",t)}const e=document.getElementById("main-title"),a=document.getElementById("nav-home"),u=document.getElementById("nav-login"),k=document.getElementById("nav-register"),E=document.getElementById("nav-dashboard"),w=document.getElementById("nav-logout"),r=document.querySelector(".main-header"),f=(t=!1,y=!1,I=!1,$=!1,T=!1)=>{a&&(a.parentElement.style.display=t?"block":"none"),u&&(u.parentElement.style.display=y?"block":"none"),k&&(k.parentElement.style.display=I?"block":"none"),E&&(E.parentElement.style.display=$?"block":"none"),w&&(w.parentElement.style.display=T?"block":"none")},d=window.location.pathname,i=await O(),x=t=>!t||t.length<=2?t:t.charAt(0)+"*".repeat(t.length-2)+t.charAt(t.length-1),m=document.body;if(m.classList.remove("default-bg","team-valor-bg","team-mystic-bg","team-instinct-bg"),r&&r.classList.remove("default-bg","team-valor-bg","team-mystic-bg","team-instinct-bg"),i.loggedIn&&i.team)switch(i.team){case 1:m.classList.add("team-mystic-bg"),r&&r.classList.add("team-mystic-bg");break;case 2:m.classList.add("team-valor-bg"),r&&r.classList.add("team-valor-bg");break;case 3:m.classList.add("team-instinct-bg"),r&&r.classList.add("team-instinct-bg");break;default:m.classList.add("default-bg"),r&&r.classList.add("default-bg");break}else m.classList.add("default-bg"),r&&r.classList.add("default-bg");if(d.includes("health-check.html"))e&&(e.textContent="Service Health"),f(!0,!1,!1,!1,!1),o&&o.remove();else if(d==="/"||d.includes("index.html"))i.loggedIn?(f(!1,!1,!1,!0,!0),e&&(e.innerHTML=renderPlayerBadge({userId:i.userId,publicId:i.publicId}))):(f(!1,!0,!0,!1,!1),e&&(e.textContent="PokÃ©mon GO Player Dashboard"));else if(d.includes("login.html"))e&&(e.textContent="Login"),f(!0,!1,!0,!1,!1);else if(d.includes("register.html"))e&&(e.textContent="Register"),f(!0,!0,!1,!1,!1);else if(d.includes("/me")||d.includes("private.html"))if(f(!0,!1,!1,!1,!0),e&&i.userId){const t=renderPlayerBadge({userId:i.userId,publicId:i.publicId});e.innerHTML=`${i.username} | ${t}`}else e&&(e.textContent=i.username||"Player Dashboard");const B=document.querySelector(".header-nav");B&&B.classList.add("nav-ready");const h=document.getElementById("theme-light"),b=document.getElementById("theme-dark"),p=t=>{document.body.setAttribute("data-theme",t),localStorage.setItem("theme",t),h&&b&&(t==="dark"?(h.classList.remove("active"),b.classList.add("active")):(h.classList.add("active"),b.classList.remove("active")))},P=localStorage.getItem("theme")||"light";p(P),h&&h.addEventListener("click",()=>p("light")),b&&b.addEventListener("click",()=>p("dark"));const g=document.getElementById("lite-mode-toggle"),N=document.getElementById("lite-mode-icon"),M=t=>{t?(document.body.classList.add("lite-mode"),g&&g.classList.add("active")):(document.body.classList.remove("lite-mode"),g&&g.classList.remove("active"))},H=localStorage.getItem("liteMode")==="enabled";M(H),g&&g.addEventListener("click",()=>{const y=!(localStorage.getItem("liteMode")==="enabled");localStorage.setItem("liteMode",y?"enabled":"disabled"),window.location.reload()});const L=document.querySelector(".burger-menu"),l=document.querySelector(".main-nav");L&&l&&(L.addEventListener("click",t=>{t.stopPropagation(),l.classList.toggle("open")}),l.addEventListener("click",t=>{t.target.classList.contains("nav-link")&&l.classList.remove("open")})),document.addEventListener("click",t=>{if(l&&l.classList.contains("open")){const y=l.contains(t.target),I=L.contains(t.target);!y&&!I&&l.classList.remove("open")}})}catch(s){console.error("loadHeader.js: Failed to load header:",s)}});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(n=>{}).catch(n=>{console.error("ServiceWorker registration failed: ",n)})});
