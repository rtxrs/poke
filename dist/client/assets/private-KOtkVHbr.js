import"./loadHeader-Bd6gbVJt.js";document.addEventListener("DOMContentLoaded",()=>{let o=null;const f=i=>{if(!i)return;const d=i.scrollLeft,M=i.scrollWidth,k=i.clientWidth,C=2,I=d>C,G=d<M-k-C;I?i.classList.add("scroll-left"):i.classList.remove("scroll-left"),G?i.classList.add("scroll-right"):i.classList.remove("scroll-right")},S=()=>(o=document.querySelector(".sub-header"),o?(o.addEventListener("scroll",()=>f(o)),f(o),window.addEventListener("resize",()=>f(o)),!0):!1);S()||new MutationObserver((d,M)=>{S()&&M.disconnect()}).observe(document.body,{childList:!0,subtree:!0});let p=0;const O=setInterval(()=>{p++,o||p>20?(clearInterval(O),o&&f(o)):S()},500)});const{createApp:Qt,ref:h,computed:_,onMounted:es,watch:le,watchEffect:ts,nextTick:cs}=Vue,Ge={1:.094,1.5:.1351374318,2:.16639787,2.5:.192650919,3:.21573247,3.5:.2365726613,4:.25572005,4.5:.2735303812,5:.29024988,5.5:.3060573775,6:.3210876,6.5:.3354450362,7:.34921268,7.5:.3624577511,8:.3752356,8.5:.387592416,9:.39956728,9.5:.4111935514,10:.4225,10.5:.4329264091,11:.44310755,11.5:.4530599591,12:.4627984,12.5:.472336093,13:.48168495,13.5:.4908558003,14:.49985844,14.5:.508701765,15:.51739395,15.5:.5259425113,16:.5343543,16.5:.5426357375,17:.5507927,17.5:.5588305862,18:.5667545,18.5:.5745691333,19:.5822789,19.5:.5898879072,20:.5974,20.5:.6048236651,21:.6121573,21.5:.6194041216,22:.6265671,22.5:.6336491432,23:.64065295,23.5:.6475809666,24:.65443563,24.5:.6612192524,25:.667934,25.5:.6745818959,26:.6811649,26.5:.6876849038,27:.69414365,27.5:.70054287,28:.7068842,28.5:.7131691091,29:.7193991,29.5:.7255756136,30:.7317,30.5:.7377694897,31:.7437366,31.5:.749609799,32:.7553897,32.5:.761080073,33:.7666845,33.5:.772199568,34:.7776309,34.5:.782983635,35:.7882599,35.5:.793460966,36:.7985881,36.5:.803645071,37:.8086304,37.5:.813544863,38:.8183946,38.5:.823179625,39:.7846369743347168,39.5:.7874736085132754,40:.7903000116348267,40.5:.792803968023538,41:.7953000068664551,41.5:.7978038983716224,42:.8003000020980835,42.5:.8028038718775964,43:.8052999973297119,43.5:.8078038508470536,44:.8102999925613403,44.5:.812803835179168,45:.8152999877929688,45.5:.8178037928037928,46:.8203000020980835,46.5:.822803776019539,47:.82530000925064,47.5:.827803755931569,48:.830300023555755,48.5:.832803729034748,49:.835300018787384,49.5:.837803755931569,50:.840300023555755,50.5:.842803729034748,51:.845300018787384,51.5:.847803702398935,52:.850300014019012,52.5:.852803676019539,53:.85530000925064,53.5:.857803649892077,54:.860300004482269,54.5:.862803624012168,55:.865299999713897};function ss(o){let f=null,S=1/0;for(const p in Ge){const O=Math.abs(Ge[p]-o);O<S&&(S=O,f=p)}return f}function je(o){return!o||o.length===0?"":`--pokemon-bg: ${o.length===1?o[0]:`linear-gradient(135deg, ${o[0]} 30%, ${o[1]} 70%)`};`}function Ke(o){return o>=100?"#ff8000":o>=80?"#2196f3":o>=60?"#4caf50":"#6c757d"}const as=o=>o?`https://leekduck.com/assets/img/types/${o.toLowerCase()}.png`:"";function Ne(o){return o?((o.individualAttack+o.individualDefense+o.individualStamina)/45*100).toFixed(1):0}function X(o){return o?(o.individualAttack+o.individualDefense+o.individualStamina)/45*100:0}function Ye(o){return"pokemon-card"}function He(o,f,S=!0){const p=[];if(!o||!o.pokemonDisplay)return f;o.pokemonDisplay.isStrongPokemon&&p.push('<span class="badge mighty-badge">Mighty</span>'),o.pokemonDisplay.shiny&&p.push('<span class="badge shiny-badge">Shiny</span>'),o.isLucky?p.push('<span class="badge lucky-badge">Lucky</span>'):o.tradedTimeMs>0&&p.push('<span class="badge traded-badge">Traded</span>');const O=Ne(o);if(o.individualAttack===0&&o.individualDefense===0&&o.individualStamina===0?p.push('<span class="badge zero-iv-badge">0 IV</span>'):parseFloat(O)>=100&&p.push('<span class="badge perfect-badge">Perfect</span>'),o.pokemonDisplay.alignment===1&&p.push('<span class="badge shadow-badge">Shadow</span>'),o.pokemonDisplay.alignment===2&&p.push('<span class="badge purified-badge">Purified</span>'),o.pokemonClass==="POKEMON_CLASS_LEGENDARY"&&p.push('<span class="badge legendary-badge">Legendary</span>'),o.pokemonClass==="POKEMON_CLASS_MYTHIC"&&p.push('<span class="badge mythical-badge">Mythical</span>'),o.pokemonDisplay.breadModeEnum===1&&p.push('<span class="badge dynamax-badge">Dynamax</span>'),o.pokemonDisplay.breadModeEnum===2&&p.push('<span class="badge gigantamax-badge">G-Max</span>'),o.isMaxLevel&&p.push('<span class="badge max-level-badge">Lvl50</span>'),o.pokemonDisplay.locationCard&&p.push('<span class="badge background-badge">Background</span>'),o.rankGreat&&o.cp<=1500&&(!S||o.rankGreat<=100)){let i="";o.rankGreat<=10?i=" rank-1":o.rankGreat<=25&&(i=" rank-good"),p.push(`<span class="badge pvp-badge great${i}" title="Great League Rank #${o.rankGreat}">#${o.rankGreat}</span>`)}if(o.rankUltra&&o.cp<=2500&&(!S||o.rankUltra<=100)){let i="";o.rankUltra<=10?i=" rank-1":o.rankUltra<=25&&(i=" rank-good"),p.push(`<span class="badge pvp-badge ultra${i}" title="Ultra League Rank #${o.rankUltra}">#${o.rankUltra}</span>`)}if(o.rankMaster&&(!S||o.rankMaster<=100)){let i="";o.rankMaster<=10?i=" rank-1":o.rankMaster<=25&&(i=" rank-good"),p.push(`<span class="badge pvp-badge master${i}" title="Master League Rank #${o.rankMaster}">#${o.rankMaster}</span>`)}return p.length>0?f?`${f}<br>${p.join(" ")}`:p.join(" "):f}function os(o,f,S,p){const O=f.startsWith("!"),i=O?f.substring(1):f;let d=!1;if(i.startsWith("#"))i.substring(1).toLowerCase()==="mighty"&&(d=o.pokemonDisplay.isStrongPokemon);else if(i.startsWith("@")){const M=i.substring(1).toLowerCase(),k=p.value[o.move1]?.name.toLowerCase(),C=p.value[o.move2]?.name.toLowerCase(),I=p.value[o.move3]?.name.toLowerCase();if(k===M||C===M||I===M)d=!0;else{const G=p.value[o.move1]?.type.toLowerCase(),V=p.value[o.move2]?.type.toLowerCase(),Z=p.value[o.move3]?.type.toLowerCase();(G===M||V===M||Z===M)&&(d=!0)}}else if(i.startsWith("+")){const M=i.substring(1).toLowerCase();o.name.toLowerCase().includes(M)&&(d=!0)}else if(i.match(/^(cp|hp)(\d+)-(\d*)$/)){const M=i.match(/^(cp|hp)(\d+)-(\d*)$/),k=M[1],C=Number(M[2]),I=M[3]?Number(M[3]):1/0,G=k==="cp"?o.cp:o.stamina;G>=C&&G<=I&&(d=!0)}else if(i.match(/^(cp|hp)-(\d+)$/)){const M=i.match(/^(cp|hp)-(\d+)$/),k=M[1],C=Number(M[2]);(k==="cp"?o.cp:o.stamina)<=C&&(d=!0)}else if(i.match(/^\d\*$/)){const M=parseInt(i),k=X(o);(M===4&&k===100||M===3&&k>=82.2&&k<100||M===2&&k>=66.7&&k<82.2||M===1&&k>=51.1&&k<66.7||M===0&&k<51.1)&&(d=!0)}else if(i.match(/^\d+$/))o.pokemonId==i&&(d=!0);else if((o.typeColors||[]).map(k=>{for(const C in S.value.typeColorMap)if(S.value.typeColorMap[C]===k)return C.toLowerCase()}).includes(i))d=!0;else if((o.name||"").toLowerCase().includes(i)||(o.nickname||"").toLowerCase().includes(i))d=!0;else if(i==="shiny"&&o.pokemonDisplay.shiny)d=!0;else if(i==="lucky"&&o.isLucky)d=!0;else if(i==="perfect"&&X(o)===100)d=!0;else if(i==="nundo"&&X(o)===0)d=!0;else if(i==="shadow"&&o.pokemonDisplay.alignment===1)d=!0;else if(i==="purified"&&o.pokemonDisplay.alignment===2)d=!0;else if(i==="dynamax"&&o.pokemonDisplay.breadModeEnum===1)d=!0;else if(i==="gigantamax"&&o.pokemonDisplay.breadModeEnum===2)d=!0;else if(i==="legendary"&&o.pokemonClass==="POKEMON_CLASS_LEGENDARY")d=!0;else if(i==="mythical"&&o.pokemonClass==="POKEMON_CLASS_MYTHIC")d=!0;else if(i==="hatched"&&o.hatchedFromEgg)d=!0;else if(i==="traded"&&o.tradedTimeMs>0)d=!0;else if(i==="favorite"&&o.favorite)d=!0;else if(i==="background"&&o.pokemonDisplay.locationCard)d=!0;else if(i.startsWith("age")){const k=parseInt(i.substring(3));(Date.now()-o.creationTimeMs)/(1e3*60*60*24)<=k&&(d=!0)}else if(i.match(/^(gl|ul|ml)(\d+)$/)){const k=i.match(/^(gl|ul|ml)(\d+)$/),C=k[1],I=parseInt(k[2]);(C==="gl"&&o.rankGreat===I||C==="ul"&&o.rankUltra===I||C==="ml"&&o.rankMaster===I)&&(d=!0)}else if(i.match(/^(gl|ul|ml)-(\d+)$/)){const k=i.match(/^(gl|ul|ml)-(\d+)$/),C=k[1],I=parseInt(k[2]);(C==="gl"&&o.rankGreat&&o.rankGreat<=I||C==="ul"&&o.rankUltra&&o.rankUltra<=I||C==="ml"&&o.rankMaster&&o.rankMaster<=I)&&(d=!0)}else i==="pvp"&&(o.rankGreat&&o.rankGreat<=100||o.rankUltra&&o.rankUltra<=100||o.rankMaster&&o.rankMaster<=100)&&(d=!0);return O?!d:d}function Le(o,f,S,p){if(!f.trim())return o;const O=f.toLowerCase().match(/(\d+\*)|(!?#\w+(-\w*)*)|(!?@?\w+(-\w*)*)|(\d+-\d*)|(-\d+)|(\+?\w+)|([,&;:])|(\w+)/g)||[],i=[],d=[],M={"&":2,",":1,";":1,":":1};for(O.forEach(k=>{if(k.match(/(\d+\*)|(!?#\w+(-\w*)*)|(!?@?\w+(-\w*)*)|(\d+-\d*)|(-\d+)|(\+?\w+)/))i.push(k);else if(k==="&"||k===","||k===";"||k===":"){for(;d.length>0&&M[d[d.length-1]]>=M[k];)i.push(d.pop());d.push(k)}});d.length>0;)i.push(d.pop());return o.filter(k=>{const C=[];return i.forEach(I=>{if(I==="&"||I===","||I===";"||I===":"){const G=C.pop(),V=C.pop();I==="&"?C.push(V&&G):C.push(V||G)}else C.push(os(k,I,S,p))}),C[0]})}const ns={props:["pokemons","isLiteMode"],emits:["pokemon-clicked"],template:`
        <div id="all-pokemon-list">
            <div v-for="p in pokemons" :key="p.id" :class="getCardClass(p)" @click="$emit('pokemon-clicked', p)">
                <div class="pokemon-image-container" :style="createBackgroundStyle(p.typeColors)">
                    <img :src="p.sprite" :alt="displayName(p)" loading="lazy">
                </div>
                <p class="pokemon-name">
                    <span :class="{'lite-name-span': isLiteMode}" 
                          :style="isLiteMode ? createBackgroundStyle(p.typeColors) : ''">
                        {{ displayName(p) }}
                    </span>
                    <br v-if="getBadges(p, '', true)">
                    <span v-html="getBadges(p, '', true)"></span>
                </p>
                <p class="pokemon-cp">CP {{ p.cp }}</p>
                <p v-if="p.score" class="pokemon-score">{{ p.scoreLabel || 'Score' }}: {{ p.score.toFixed(2) }}</p>
                <div class="iv-bar-container">
                    <div class="iv-bar" :style="{ width: getIvPercent(p) + '%', backgroundColor: getIvColor(getIvPercent(p)) }"></div>
                </div>
                <small>{{ getIvPercent(p) }}% ({{ p.individualAttack }}/{{ p.individualDefense }}/{{ p.individualStamina }})</small>
            </div>
        </div>
    `,methods:{displayName(o){return o.nickname||o.name},getIvPercent:Ne,getBadges:He,getCardClass:Ye,createBackgroundStyle:je,getIvColor:Ke}},rs={props:["raidBosses","selectedRaidBoss","createBackgroundStyle","isLiteMode"],emits:["boss-selected"],setup(o){return{groupedBosses:Vue.computed(()=>{const p={};o.raidBosses.forEach(d=>{p[d.level]||(p[d.level]=[]),p[d.level].push(d)});const O=["mega","shadow_lvl5","lvl5","shadow_lvl3","lvl3","shadow_lvl1","lvl1"],i={};return O.forEach(d=>{p[d]&&(i[d]=p[d])}),i}),getBossImage:p=>p.assets&&p.assets.image?p.assets.image:"https://raw.githubusercontent.com/PokeMiners/pogo_assets/master/Images/Pokemon/pokemon_icon_000.png"}},template:`
        <div class="raid-boss-selector">
            <div v-for="(bosses, level) in groupedBosses" :key="level" class="raid-boss-group">
                <h3 class="raid-boss-level-title">{{ level.replace('_', ' ').toUpperCase() }}</h3>
                <div class="raid-boss-icons">
                    <template v-for="boss in bosses" :key="boss.id">
                        <div v-if="!isLiteMode"
                             class="pokemon-image-container"
                             :class="{ selected: boss.id === selectedRaidBoss }"
                             :style="createBackgroundStyle(boss.typeColors)"
                             @click="$emit('boss-selected', boss.id)">
                            <img :src="getBossImage(boss)" :alt="boss.names.English">
                        </div>
                        <span v-else
                              class="lite-name-span clickable-boss"
                              :class="{ selected: boss.id === selectedRaidBoss }"
                              :style="createBackgroundStyle(boss.typeColors)"
                              @click="$emit('boss-selected', boss.id)">
                            {{ boss.names.English }}
                        </span>
                    </template>
                </div>
            </div>
        </div>
    `},ls={props:["maxBattles","selectedMaxBoss","createBackgroundStyle","isLiteMode"],emits:["boss-selected"],setup(o){return{groupedBosses:Vue.computed(()=>{const p={};o.maxBattles.forEach(d=>{p[d.level]||(p[d.level]=[]),p[d.level].push(d)});const O=Object.keys(p).sort().reverse(),i={};return O.forEach(d=>i[d]=p[d]),i}),getBossImage:p=>p.assets&&p.assets.image?p.assets.image:"https://raw.githubusercontent.com/PokeMiners/pogo_assets/master/Images/Pokemon/pokemon_icon_000.png"}},template:`
        <div class="raid-boss-selector">
            <div v-for="(bosses, level) in groupedBosses" :key="level" class="raid-boss-group">
                <h3 class="raid-boss-level-title">{{ level.replace('tier', 'TIER ') }}</h3>
                <div class="raid-boss-icons">
                    <template v-for="boss in bosses" :key="boss.id">
                        <div v-if="!isLiteMode"
                             class="pokemon-image-container"
                             :class="{ selected: boss.id === selectedMaxBoss }"
                             :style="createBackgroundStyle(boss.typeColors)"
                             @click="$emit('boss-selected', boss.id)">
                            <img :src="getBossImage(boss)" :alt="boss.names.English">
                        </div>
                        <span v-else
                              class="lite-name-span clickable-boss"
                              :class="{ selected: boss.id === selectedMaxBoss }"
                              :style="createBackgroundStyle(boss.typeColors)"
                              @click="$emit('boss-selected', boss.id)">
                            {{ boss.names.English }}
                        </span>
                    </template>
                </div>
            </div>
        </div>
    `};Qt({components:{"grid-component":ns,"raid-boss-selector":rs,"max-boss-selector":ls},setup(){const o=h(!0),f=h([]),S=h({}),p=h({}),O=h([]),i=h({typeColorMap:{},pokedex:null}),d=h("character"),M=h(""),k=h("");let C=null;le(M,e=>{C&&clearTimeout(C),C=setTimeout(()=>{k.value=e},150)});const I=h("caughtTime"),G=h(!1),V={caughtTime:"desc",cp:"desc",pokedex:"asc",name:"asc"},Z=h(V.caughtTime);le(I,e=>{Z.value=V[e]});const ke=h(null),B=h({}),q=h({}),_e=h(0),qe=h(localStorage.getItem("liteMode")==="enabled"),ze=_(()=>{if(!f.value||f.value.length===0)return{percent:0,shinyCount:0,totalCount:0};const e=f.value.length,t=f.value.filter(n=>n.pokemonDisplay?.shiny).length;return{percent:e>0?Math.round(t/e*100):0,shinyCount:t,totalCount:e}}),We=_(()=>{const e=f.value.filter(r=>r.individualAttack===15&&r.individualDefense===15&&r.individualStamina===15).length,t=f.value.filter(r=>r.individualAttack===0&&r.individualDefense===0&&r.individualStamina===0).length,s=e+t,n=s>0?Math.round(e/s*100):1,a=s>0?Math.round(t/s*100):1;return{perfect:e,nundo:t,perfectPerc:n,nundoPerc:a}}),Xe=_(()=>{if(!R.value)return[];const e=new Set;return f.value.forEach(t=>{t.hasMegaEvolved&&e.add(t.pokemonId)}),Array.from(e).map(t=>{const s=R.value[t],n=s?.NORMAL||Object.values(s||{})[0];return{id:t,sprite:n?.assets?.image||""}})}),Ve=_(()=>{const e=Array(10).fill(0);f.value.forEach(n=>{const a=(n.individualAttack+n.individualDefense+n.individualStamina)/45*100,r=Math.min(9,Math.floor(a/10));e[r]++});const t=Math.max(...e),s=["0-10","11-20","21-30","31-40","41-50","51-60","61-70","71-80","81-90","91-100"];return e.map((n,a)=>({label:s[a],count:n,height:t>0?n/t*100:0}))}),Ze=_(()=>{const e=f.value.filter(s=>s.tradedTimeMs>0);if(e.length===0)return{percent:0,luckyCount:0,tradedCount:0};const t=e.filter(s=>s.isLucky).length;return{percent:Math.round(t/e.length*100),luckyCount:t,tradedCount:e.length}}),Je=_(()=>{let e=0;f.value.forEach(s=>{const n=Q(s);(n?.pokemonClass==="POKEMON_CLASS_LEGENDARY"||n?.pokemonClass==="POKEMON_CLASS_MYTHIC")&&e++});const t=f.value.length;return t===0?{percent:0,legendaryMythicalCount:0,totalCount:0}:{percent:Math.round(e/t*100),legendaryMythicalCount:e,totalCount:t}}),Qe=_(()=>{const e={"0-1k":0,"1k-2k":0,"2k-3k":0,"3k-4k":0,"4k+":0};f.value.forEach(s=>{s.cp<=1e3?e["0-1k"]++:s.cp<=2e3?e["1k-2k"]++:s.cp<=3e3?e["2k-3k"]++:s.cp<=4e3?e["3k-4k"]++:e["4k+"]++});const t=Math.max(...Object.values(e));return Object.entries(e).map(([s,n])=>({label:s,count:n,height:t>0?n/t*100:0}))}),et=_(()=>{const e={};f.value.forEach(s=>{const n=new Date(s.creationTimeMs).getFullYear();e[n]=(e[n]||0)+1});const t=Math.max(...Object.values(e));return Object.entries(e).sort(([s],[n])=>s-n).map(([s,n])=>({label:s,count:n,height:t>0?n/t*100:0}))}),tt=_(()=>{if(!R.value||f.value.length===0)return[];const e=f.value.reduce((a,r)=>(a[r.pokemonId]=(a[r.pokemonId]||0)+1,a),{}),s=Object.entries(e).sort(([,a],[,r])=>r-a).slice(0,5),n=s.length>0?s[0][1]:0;return s.map(([a,r])=>{let m=`ID ${a}`;const g=R.value[a];if(g){const u=g.NORMAL||Object.values(g)[0];u&&u.names&&u.names.English&&(m=u.names.English)}return{name:m,count:r,width:n>0?r/n*100:0}})}),st=_(()=>{let e=0,t=0,s=0,n=0;f.value.forEach(u=>{u.tradedTimeMs>0?n++:u.hatchedFromEgg?t++:u.originDetail?.originDetailCase===3?s++:e++});const a=f.value.length;if(a===0)return{wildEnd:0,hatchedEnd:0,raidEnd:0,wild:e,hatched:t,raid:s,trade:n};const r=Math.round(e/a*100),m=r+Math.round(t/a*100),g=m+Math.round(s/a*100);return{wildEnd:r,hatchedEnd:m,raidEnd:g,wild:e,hatched:t,raid:s,trade:n}}),at=_(()=>({1:"#3498DB",2:"#E74C3C",3:"#F1C40F"})[S.value.team]||"#ccc"),ot=_(()=>{if(!p.value.nextLevelExp)return 0;const e=p.value.nextLevelExp-p.value.prevLevelExp,t=p.value.experience-p.value.prevLevelExp;return Math.min(100,Math.max(0,t/e*100))}),nt=_(()=>{if(!p.value.nextLevelExp)return"0 / 0 XP";const e=p.value.nextLevelExp-p.value.prevLevelExp,t=p.value.experience-p.value.prevLevelExp;return`${Math.max(0,t).toLocaleString()} / ${e.toLocaleString()} XP`}),rt=_(()=>S.value.currencyBalance?.find(e=>e.currencyType==="STARDUST")?.quantity||0),lt=_(()=>S.value.currencyBalance?.find(e=>e.currencyType==="POKECOIN")?.quantity||0),Q=e=>{if(!R.value||!R.value[e.pokemonId])return null;const t=Object.values(R.value[e.pokemonId])[0];if(!t)return null;const s=e.pokemonDisplay.formName?.toUpperCase()||"";if(t.regionForms){for(const m in t.regionForms)if(s.includes(m.replace(/_/g,"")))return t.regionForms[m]}const n=R.value[e.pokemonId],a=n.NORMAL||t;if(!s||s==="UNSET"||s.includes("NORMAL"))return a;const r=s.replace(/_/g,"").replace(/-/g,"").replace(/\s/g,"");for(const m in n){const g=n[m],u=m.toUpperCase().replace(/_/g,"").replace(/-/g,"").replace(/\s/g,"");if(r.includes(u))return g}return a},ee=e=>{if(!e)return 0;let t=0;const s=(e.individualAttack+e.individualDefense+e.individualStamina)/45*100;return s>=100?t+=30:s===0&&(t+=20),e.pokemonDisplay?.shiny&&(t+=25),e.isMaxLevel&&(t+=20),e.pokemonDisplay.locationCard&&(t+=20),e.pokemonDisplay?.alignment===1&&(t+=15),e.pokemonClass==="POKEMON_CLASS_MYTHIC"&&(t+=15),t},we=(e,t=[])=>{if(!e||!K.value||!R.value)return null;const s=Q(e);if(!s||!s.stats)return null;const n=e.cpMultiplier+(e.additionalCpMultiplier||0);let a=(s.stats.attack+e.individualAttack)*n;e.pokemonDisplay.alignment===1&&(a*=1.2);const r=[];s.primaryType?.type&&r.push(s.primaryType.type.replace("POKEMON_TYPE_","").toLowerCase()),s.secondaryType?.type&&r.push(s.secondaryType.type.replace("POKEMON_TYPE_","").toLowerCase());const m=(c,y)=>(y?K.value.chargedMoves:K.value.fastMoves).find(D=>D.move_id==c),g=m(e.move1,!1);if(!g)return null;const u=c=>{if(!t||t.length===0||!A.value)return 1;let y=1;const b=c.charAt(0).toUpperCase()+c.slice(1).toLowerCase();return t.forEach(L=>{const D=L.charAt(0).toUpperCase()+L.slice(1).toLowerCase();A.value[b]&&A.value[b][D]&&(y*=A.value[b][D])}),y},l={},v=c=>{const y=m(c,!0);if(!y)return 0;const b=r.includes(g.type.toLowerCase())?1.2:1,L=r.includes(y.type.toLowerCase())?1.2:1,D=u(g.type),$=u(y.type),N=Math.abs(y.energy_delta),T=g.energy_delta;if(T<=0)return 0;const w=Math.ceil(N/T),E=g.power*b*D*w,F=y.power*L*$,Y=E+F,z=g.duration*w,x=y.duration,W=z+x,re=Y/(W/1e3);return a/200*re};return e.move2&&(l.move2=v(e.move2)),e.move3&&(l.move3=v(e.move3)),l},it=_(()=>!f.value||f.value.length===0?[]:[...f.value].sort((t,s)=>ee(s)-ee(t)||s.cp-t.cp).slice(0,9)),ct=["Poké Balls","Potions & Revives","Berries","Special Items","Battle & TMs","Miscellaneous"],ie=_(()=>{if(!O.value)return{};const e={"Poké Balls":["PokeBall","GreatBall","UltraBall"],"Potions & Revives":["Potion","SuperPotion","HyperPotion","MaxPotion","Revive","MaxRevive"],Berries:["GoldenRazzBerry","GoldenPinapBerry","RazzBerry","PinapBerry","NanabBerry"],"Special Items":["RareCandy","XlRareCandy","LuckyEgg","StarPiece","IncenseOrdinary","TroyDisk"],"Battle & TMs":["MoveRerollFastAttack","MoveRerollSpecialAttack","ShadowGem","ShadowGemFragment"]},t={};for(const s in e)e[s].forEach(n=>{t[n]=s});return O.value.filter(s=>s.count>0&&!s.itemName.includes("Unlimited")&&!s.itemName.includes("Camera")).reduce((s,n)=>{const a=t[n.itemName]||"Miscellaneous";return s[a]||(s[a]=[]),s[a].push(n),s},{})}),ut=_(()=>(ie.value["Poké Balls"]||[]).reduce((e,t)=>e+t.count,0)),dt=_(()=>(ie.value["Potions & Revives"]||[]).filter(e=>e.itemName.includes("Potion")).reduce((e,t)=>e+t.count,0)),mt=_(()=>(ie.value["Potions & Revives"]||[]).filter(e=>e.itemName.includes("Revive")).reduce((e,t)=>e+t.count,0)),pt=_(()=>{let e=Le([...f.value],k.value,i,B);return e.sort((t,s)=>{let n,a;switch(I.value){case"cp":n=t.cp,a=s.cp;break;case"pokedex":n=t.pokemonId,a=s.pokemonId;break;case"name":return(t.nickname||t.name).localeCompare(s.nickname||s.name);default:n=t.creationTimeMs,a=s.creationTimeMs;break}return n-a}),Z.value==="desc"&&e.reverse(),e}),ce=h(!1),ye=h(""),ft=h(!1),vt=_(()=>{const t=Le(f.value,ye.value,i,B).reduce((n,a)=>(n[a.pokemonId]||(n[a.pokemonId]=[]),n[a.pokemonId].push(a),n),{}),s=Object.values(t).filter(n=>n.length>1);return s.sort((n,a)=>a.length-n.length),s.forEach(n=>{n.sort((a,r)=>ee(r)-ee(a)||X(r)-X(a)||r.cp-a.cp)}),s}),gt=_(()=>{const t=Le(f.value,ye.value,i,B).reduce((a,r)=>(a[r.pokemonId]||(a[r.pokemonId]=[]),a[r.pokemonId].push(r),a),{}),n=Object.values(t).filter(a=>a.length>1).map(a=>{const r=g=>{const u=g.pokemonDisplay.formName||"NORMAL",l=g.pokemonDisplay.costume||"NONE";return`${u}-${l}`},m=a.reduce((g,u)=>{const l=r(u);return g[l]||(g[l]=[]),g[l].push(u),g},{});return Object.values(m).forEach(g=>{g.sort((u,l)=>ee(l)-ee(u)||X(l)-X(u)||l.cp-u.cp)}),{speciesName:a[0].name,count:a.length,forms:Object.entries(m).map(([g,u])=>{const[l,v]=g.split("-");let c="";l!=="NORMAL"&&(c=l.replace(/_/g," ").toLowerCase(),c=c.charAt(0).toUpperCase()+c.slice(1));let y="";v!=="NONE"&&q.value[v]&&(y=q.value[v].replace(/_/g," ").toLowerCase(),y=y.charAt(0).toUpperCase()+y.slice(1));let b=c;return y?(b=y,c&&(b+=` (${c})`)):c||(b="Normal"),{displayName:b,pokemons:u}})}});return n.sort((a,r)=>r.count-a.count),n}),ue=h(!1),Me=h(null),de=h([]),me=h([]),be=h(null),A=h({}),te=h("raid"),j=h([]),pe=h("Overall"),P=h([]),R=_(()=>{if(!P.value)return{};const e={};return P.value.forEach(t=>{const s=t.dexNr;e[s]||(e[s]={});let n=t.formId||"NORMAL";e[s][n]=t}),e}),ht=_(()=>{if(!P.value)return[];const e=new Set;return P.value.forEach(t=>{if(e.add(t.names.English),t.regionForms&&Object.values(t.regionForms).forEach(s=>e.add(s.names.English)),t.hasMegaEvolution&&t.megaEvolutions)for(const s in t.megaEvolutions)e.add(t.megaEvolutions[s].names.English)}),Array.from(e).sort()}),Ce=h(""),se=h("standard"),ae=h({}),fe=h(!1),oe=h(0),ve=h([]),ge=h(!1),kt=50,he=h("132"),ne=h(null),Ee=h(!1),yt=_(()=>{const e=he.value;return e==="132"&&(!S.value.preferences||!S.value.preferences.avatarId)?"https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/showdown/132.gif":`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${e}.png`}),Mt=async()=>{if(fe.value=!0,ne.value=he.value,oe.value===0){if(P.value)if(Array.isArray(P.value)){let e=0;P.value.forEach(t=>{t.id&&typeof t.id=="number"&&t.id>e?e=t.id:t.dexNr&&typeof t.dexNr=="number"&&t.dexNr>e&&(e=t.dexNr)}),oe.value=e>0?e:1025}else typeof P.value=="object"?oe.value=Object.keys(P.value).length:oe.value=1025;else oe.value=1025;Ie()}},Ie=()=>{if(ge.value)return;ge.value=!0;const e=ve.value.length,t=[];for(let s=1;s<=kt;s++){const n=e+s;if(n>oe.value)break;t.push(n)}ve.value=[...ve.value,...t],ge.value=!1},bt=e=>{const{scrollTop:t,clientHeight:s,scrollHeight:n}=e.target;t+s>=n-50&&Ie()},Ct=e=>{ne.value=e},Et=async()=>{if(ne.value){Ee.value=!0;try{const e=await fetch("/api/update-preferences",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({preferences:{avatarId:ne.value.toString()}})});if(e.ok){const t=await e.json();he.value=ne.value,S.value.preferences=t.preferences,fe.value=!1}else alert("Failed to save avatar preference.")}catch(e){console.error("Save avatar error:",e),alert("An error occurred while saving.")}finally{Ee.value=!1}}},St=()=>{ue.value=!0},Lt=()=>{ue.value=!1},Nt=(e,t)=>{const s=Q(e);if(!s||!s.stats)return 0;const n=e.cpMultiplier+(e.additionalCpMultiplier||0),a=(s.stats.defense+e.individualDefense)*n,r=(s.stats.stamina+e.individualStamina)*n;let m=1;const g=[];return s.primaryType?.names?.English&&g.push(s.primaryType.names.English),s.secondaryType?.names?.English&&g.push(s.secondaryType.names.English),A.value&&t&&t.forEach(u=>{const l=u.charAt(0).toUpperCase()+u.slice(1).toLowerCase();g.forEach(v=>{const c=v.charAt(0).toUpperCase()+v.slice(1).toLowerCase();A.value[l]&&A.value[l][c]&&(m*=A.value[l][c])})}),a*r/m},_t=(e,t)=>{const s=we(e,t);if(!s)return 0;const n=Math.max(s.move2||0,s.move3||0);if(n===0)return 0;const a=Nt(e,t);return Math.pow(n,1.5)*a/1e5},wt=()=>{let e=[];if(te.value==="max_battle_list"){se.value="max";const r=me.value.find(m=>m.id===be.value);r&&e.push(r)}else if(te.value==="raid"){const r=de.value.find(m=>m.id===Me.value);r&&e.push(r)}else e=j.value;if(e.length===0){ae.value={};return}const t={},s={};let n=f.value;se.value==="max"&&(n=f.value.filter(r=>r.pokemonDisplay.breadModeEnum===1||r.pokemonDisplay.breadModeEnum===2)),n.forEach(r=>{s[r.id]={...r,score:0}}),e.forEach(r=>{const m=r.types;if(!m||m.length===0){t[r.names.English]=[];return}if(se.value==="max"){const g=n.map(c=>{const y=c.pokemonDisplay.breadModeEnum===2;let b=1,L=1,D=1;c.breadMoves&&c.breadMoves.length>0&&c.breadMoves.forEach(U=>{U.moveType===1?b=U.moveLevel:U.moveType===2?L=U.moveLevel:U.moveType===3&&(D=U.moveLevel)});let $=0;y?$=350+(b-1)*50:$=250+(b-1)*50;const N=Q(c),T=c.cpMultiplier+(c.additionalCpMultiplier||0),w=(N.stats.attack+c.individualAttack)*T,E=[];N.primaryType?.names?.English&&E.push(N.primaryType.names.English.toUpperCase()),N.secondaryType?.names?.English&&E.push(N.secondaryType.names.English.toUpperCase());const F=K.value.fastMoves.find(U=>U.move_id==c.move1);let Y=F?F.type:"Normal";const z=E.includes(Y.toUpperCase())?1.2:1;let x=1;if(m&&m.length>0&&A.value){const U=Y.charAt(0).toUpperCase()+Y.slice(1).toLowerCase();m.forEach(Fe=>{const Ue=Fe.charAt(0).toUpperCase()+Fe.slice(1).toLowerCase();A.value[U]&&A.value[U][Ue]&&(x*=A.value[U][Ue])})}const re=.5*$*w*z*x*1.1,Se=1/(F&&F.duration?F.duration/1e3:1),J=(N.stats.stamina+c.individualStamina)*T,H=Math.floor(J*2),Wt=L*20,Xt=.1+(D-1)*.02,Vt=(H+Wt)*(1+Xt*3),Zt=(N.stats.defense+c.individualDefense)*T,Re=Vt*Zt/1e4,Jt=re*Se*(Re/100);return{...c,dps:re*Se,bulk:Re,score:Jt,scoreLabel:"Max Score"}}),u=[...g].sort((c,y)=>y.dps-c.dps).slice(0,6).map(c=>({...c,score:c.dps,scoreLabel:"Max Dmg"})),l=new Set(u.map(c=>c.id)),v=[...g].filter(c=>!l.has(c.id)).sort((c,y)=>y.bulk-c.bulk).slice(0,6).map(c=>({...c,score:c.bulk,scoreLabel:"Survival"}));t[r.names.English]=[...u,...v]}else{const g=n.map(u=>{const l=_t(u,m);return s[u.id].score+=l,{...u,score:l}}).sort((u,l)=>l.score-u.score);t[r.names.English]=g.slice(0,12)}});const a=Object.values(s).sort((r,m)=>m.score-r.score);t.Overall=a.slice(0,12),ae.value=t},It=_(()=>{if(te.value==="raid"){const e=de.value.find(t=>t.id===Me.value);return e?ae.value[e.names.English]||[]:[]}else if(te.value==="max_battle_list"){const e=me.value.find(t=>t.id===be.value);return e?ae.value[e.names.English]||[]:[]}else return j.value.length===0?[]:j.value.length===1?ae.value[j.value[0].names.English]||[]:ae.value[pe.value]||[]}),Dt=()=>{if(j.value.length>=6)return;const e=Ce.value;if(!e)return;let t=null,s=!1;for(const n of P.value){if(n.names.English.toLowerCase()===e.toLowerCase()){t=n;break}if(n.regionForms){for(const a of Object.values(n.regionForms))if(a.names.English.toLowerCase()===e.toLowerCase()){t=a;break}}if(n.hasMegaEvolution&&n.megaEvolutions){for(const a in n.megaEvolutions)if(n.megaEvolutions[a].names.English.toLowerCase()===e.toLowerCase()){t=n.megaEvolutions[a],s=!0;break}}if(t)break}if(t&&!j.value.some(n=>n.names.English===t.names.English)){const n=[];t.primaryType&&n.push(t.primaryType.names.English),t.secondaryType&&n.push(t.secondaryType.names.English);const a=n.map(m=>i.value.typeColorMap[m.toUpperCase()]),r=s?`${t.id}_MEGA`:t.id;j.value.push({...t,id:r,types:n,typeColors:a,isMegaEvolution:s})}Ce.value=""},xt=e=>{j.value.splice(e,1)};ts(wt),le(te,e=>{e==="max_battle_list"?se.value="max":se.value="standard"}),le(j,e=>{e.length>1?pe.value="Overall":e.length===1&&(pe.value=e[0].names.English)},{deep:!0});const Tt=e=>{if(!e||!e.typeColors||!i.value.typeColorMap)return[];const t=i.value.typeColorMap;return e.typeColors.map(n=>{const a=Object.keys(t).find(r=>t[r]===n);return a?{name:a.charAt(0).toUpperCase()+a.slice(1).toLowerCase(),color:n}:null}).filter(Boolean)},Ot=()=>{ce.value=!0},Pt=()=>{ce.value=!1},$t=()=>{Z.value=Z.value==="desc"?"asc":"desc"},At=e=>`https://raw.githubusercontent.com/PokeMiners/pogo_assets/master/Images/Items/Item_${String(e).padStart(4,"0")}.png`,Bt=e=>B.value[e]?.name||e,Rt=e=>{const t={...e};e.move1&&B.value[e.move1]&&(t.move1Type=B.value[e.move1].type),e.move2&&B.value[e.move2]&&(t.move2Type=B.value[e.move2].type),e.move3&&B.value[e.move3]&&(t.move3Type=B.value[e.move3].type),ke.value=t,setTimeout(()=>{const s=document.querySelector('#modal-content .stat-bar-fill[data-stat="attack"]'),n=document.querySelector('#modal-content .stat-bar-fill[data-stat="defense"]'),a=document.querySelector('#modal-content .stat-bar-fill[data-stat="stamina"]');s&&(s.style.width=`${e.individualAttack/15*100}%`,s.style.backgroundColor=e.individualAttack===15?"#da7a79":"#f79513"),n&&(n.style.width=`${e.individualDefense/15*100}%`,n.style.backgroundColor=e.individualDefense===15?"#da7a79":"#f79513"),a&&(a.style.width=`${e.individualStamina/15*100}%`,a.style.backgroundColor=e.individualStamina===15?"#da7a79":"#f79513")},100)},De=()=>{const e=window.location.hash.replace("#","");["character","pokemon","pokedex","statistics","tools"].includes(e)?d.value=e:d.value="character",document.querySelectorAll(".sub-header a").forEach(s=>{s.id===`nav-${d.value}`?s.classList.add("active"):s.classList.remove("active")})},xe=h("normal"),Ft=_(()=>{if(!P.value||!f.value)return[];const e=(a,r="Normal")=>r==="Shiny"?`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/shiny/${a}.png`:`https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/home/${a}.png`,t=[],s=new Set,n={};return P.value.forEach(a=>{a.names&&a.names.English&&(n[a.dexNr]=a.names.English.toUpperCase().replace(/_/g,"").replace(/-/g,"").replace(/\s/g,""))}),f.value.forEach(a=>{const r=[""];a.pokemonDisplay.shiny&&r.push("_SHINY"),r.forEach(m=>{s.add(`${a.pokemonId}_ANY${m}`);let g=a.pokemonDisplay.formName||"NORMAL";g==="UNSET"&&(g="NORMAL");const u=g.toUpperCase().replace(/_/g,"").replace(/-/g,"").replace(/\s/g,"");let l="NONE";if(a.pokemonDisplay.costume&&a.pokemonDisplay.costume>0){const c=q.value&&q.value[a.pokemonDisplay.costume.toString()];c?l=c.toUpperCase().replace(/_/g,"").replace(/-/g,"").replace(/\s/g,""):l=`ID_${a.pokemonDisplay.costume}`}s.add(`${a.pokemonId}_FORM_${u}_COSTUME_${l}${m}`),s.add(`${a.pokemonId}_FORM_${u}${m}`);const v=n[a.pokemonId];if(v&&u.startsWith(v)&&u.length>v.length){const c=u.substring(v.length);s.add(`${a.pokemonId}_FORM_${c}_COSTUME_${l}${m}`),s.add(`${a.pokemonId}_FORM_${c}${m}`)}l!=="NONE"&&(s.add(`${a.pokemonId}_COSTUME_${l}${m}`),s.add(`${a.pokemonId}_FORM_NORMAL_COSTUME_${l}${m}`))})}),P.value.forEach(a=>{if(xe.value==="normal"){let r=null;a.assetForms&&(r=a.assetForms.find(u=>(!u.form||u.form==="NORMAL")&&(!u.costume||u.costume==="NONE")),r||(r=a.assetForms[0]));const m=s.has(`${a.dexNr}_ANY`),g=r?r.image:a.assets?.image||e(a.dexNr,"Normal");t.push({uniqueId:`${a.dexNr}_NORMAL`,dexNr:a.dexNr,name:a.names.English,sprite:g,isCaught:m})}else if(a.assetForms){const r=new Set;a.assetForms.forEach((m,g)=>{if(m.form&&m.form.match(/^PM\d+/))return;let u=m.form?m.form.toUpperCase():"NORMAL";u=u.replace(/_/g,"").replace(/-/g,"").replace(/\s/g,"");let l=m.costume?m.costume.toUpperCase():"NONE";l=l.replace(/_/g,"").replace(/-/g,"").replace(/\s/g,"");const v=`${u}_${l}`;if(r.has(v))return;r.add(v);let c=a.names.English;m.form&&m.form!=="NORMAL"&&(c+=` (${m.form})`),m.costume&&(c+=` [${m.costume}]`);let y=!1;(s.has(`${a.dexNr}_FORM_${u}_COSTUME_${l}`)||l==="NONE"&&s.has(`${a.dexNr}_FORM_${u}`)||l!=="NONE"&&s.has(`${a.dexNr}_COSTUME_${l}`)||l!=="NONE"&&s.has(`${a.dexNr}_FORM_${l}`))&&(y=!0);const b=m.image||a.assets?.image||e(a.dexNr,"Normal");if(t.push({uniqueId:`${a.dexNr}_${g}_NORMAL`,dexNr:a.dexNr,name:c,sprite:b,isCaught:y}),m.shinyImage){let L=!1;const D="_SHINY";(s.has(`${a.dexNr}_FORM_${u}_COSTUME_${l}${D}`)||l==="NONE"&&s.has(`${a.dexNr}_FORM_${u}${D}`)||l!=="NONE"&&s.has(`${a.dexNr}_COSTUME_${l}${D}`)||l!=="NONE"&&s.has(`${a.dexNr}_FORM_${l}${D}`))&&(L=!0),t.push({uniqueId:`${a.dexNr}_${g}_SHINY`,dexNr:a.dexNr,name:`${c} ✨`,sprite:m.shinyImage||e(a.dexNr,"Shiny"),isCaught:L})}})}else{const r=s.has(`${a.dexNr}_ANY`);t.push({uniqueId:`${a.dexNr}_BASIC`,dexNr:a.dexNr,name:a.names.English,sprite:a.assets?.image||e(a.dexNr,"Normal"),isCaught:r})}}),t}),Te=h(!1),Oe=()=>{let e=!1;window.scrollY>300&&(e=!0);const t=document.getElementById("all-pokemon-list");t&&t.scrollTop>300&&(e=!0),Te.value=e},Ut=()=>{window.scrollTo({top:0,behavior:"smooth"});const e=document.getElementById("all-pokemon-list");e&&e.scrollTo({top:0,behavior:"smooth"})},Gt=h(-1),K=h(null),Pe=h(!1),$e=h({keepShiny:!0,keepLucky:!0,keepShadow:!0,keepPurified:!1,keepLegendary:!0,keepCostume:!0,keepFavorite:!0,keepBackground:!0,keepXXSXXL:!0,keep4Star:!0,keepNundo:!0,useMinIv:!0,minIvPercent:90,useRankGL:!0,keepRankGL:50,useRankUL:!0,keepRankUL:50,useRankML:!0,keepRankML:50}),Ae=h([]);le([ke,ce,ue,fe,Pe],e=>{e.some(s=>!!s)?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open")});const jt=()=>{const e=$e.value,t={};f.value.forEach(r=>{t[r.pokemonId]||(t[r.pokemonId]=[]),t[r.pokemonId].push(r)});const s=[],n=[];Object.entries(t).forEach(([r,m])=>{const g=[],u=[];if(m.forEach(l=>{let v=!1;const c=X(l);(e.keepShiny&&l.pokemonDisplay.shiny||e.keepLucky&&l.isLucky||e.keepShadow&&l.pokemonDisplay.alignment===1||e.keepPurified&&l.pokemonDisplay.alignment===2||e.keepLegendary&&(l.pokemonClass==="POKEMON_CLASS_LEGENDARY"||l.pokemonClass==="POKEMON_CLASS_MYTHIC")||e.keepCostume&&l.pokemonDisplay.costume>0||e.keepFavorite&&l.favorite||e.keepBackground&&l.pokemonDisplay.locationCard||e.keepXXSXXL&&(l.size===1||l.size===5)||e.keep4Star&&c===100||e.keepNundo&&c===0||e.useMinIv&&c>=e.minIvPercent)&&(v=!0),v||(e.useRankGL&&l.rankGreat&&l.rankGreat<=e.keepRankGL&&l.cp<=1500||e.useRankUL&&l.rankUltra&&l.rankUltra<=e.keepRankUL&&l.cp<=2500||e.useRankML&&l.rankMaster&&l.rankMaster<=e.keepRankML)&&(v=!0),v?g.push(l):u.push(l)}),g.length===0&&u.length>0)s.push(r);else if(u.length>0){const l=[...new Set(g.map(v=>v.cp))];if(l.length>0){const v=l.map(c=>`!cp${c}`).join("&");n.push(`${r}&${v}`)}else s.push(r)}});const a=[];s.length>0&&a.push({desc:"Safe Species (Transfer All)",text:s.join(","),count:s.length+" species"}),n.length>0&&a.push({desc:"Selective Trash (Excludes Keepers)",text:n.join(","),count:n.length+" filter rules"}),a.length===0&&a.push({desc:"Result",text:"No trash found based on current criteria.",count:0}),Ae.value=a},Kt=e=>{navigator.clipboard.writeText(e).then(()=>{alert("Copied to clipboard!")})},Yt=e=>{const t=[];if(e?.primaryType?.type){const s=e.primaryType.type.replace("POKEMON_TYPE_","");t.push(i.value.typeColorMap[s]||"#FFFFFF")}if(e?.secondaryType?.type){const s=e.secondaryType.type.replace("POKEMON_TYPE_","");t.push(i.value.typeColorMap[s]||"#FFFFFF")}return t},Ht=(e,t)=>{const s=`Pokedex #${e}`,n=R.value[e];if(!n)return s;const a=n.NORMAL||Object.values(n)[0];if(!a)return s;const r=t||"",m=a.names&&a.names.English?a.names.English.normalize("NFD").replace(/[\u0300-\u036f]/g,""):"",g=r.replace(m,"").toUpperCase().replace(/[^A-Z0-9]/g,"").trim()||"NORMAL";return(n[g]||a)?.names?.English||s},qt=e=>{const t=`https://raw.githubusercontent.com/PokeMiners/pogo_assets/master/Images/Pokemon/pokemon_icon_${String(e.pokemonId).padStart(3,"0")}_00.png`,s=`https://raw.githubusercontent.com/PokeMiners/pogo_assets/master/Images/Pokemon/pokemon_icon_${String(e.pokemonId).padStart(3,"0")}_00_shiny.png`,n=e.pokemonDisplay&&e.pokemonDisplay.shiny?"shinyImage":"image",a=R.value[e.pokemonId],r=a?a.NORMAL||Object.values(a)[0]:null;if(!r||!r.assetForms)return e.pokemonDisplay&&e.pokemonDisplay.shiny?s:t;const m=e.pokemonDisplay&&e.pokemonDisplay.formName?e.pokemonDisplay.formName.toUpperCase():"",g=r.names.English.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");let u;e.pokemonId===201?u=m.replace(/[^A-Z0-9]/g,"").trim():u=m.replace(g,"").replace(/[^A-Z0-9]/g,"").trim(),(u===""||u==="NORMAL")&&(u=null);let l=null;const v=e.pokemonDisplay?e.pokemonDisplay.costume:null;v&&q.value[v]&&(l=q.value[v].toUpperCase().replace(/[^A-Z0-9]/g,"").trim());let c=null;const b=(e.pokemonDisplay?e.pokemonDisplay.gender:1)===2,L=(D,$)=>{const N=E=>D?E===D:!E||E==="NONE",T=E=>$&&$!=="NORMAL"?E===$:!E||E==="NORMAL";let w=r.assetForms.find(E=>N(E.costume)&&T(E.form)&&E.isFemale===b);return w||(w=r.assetForms.find(E=>N(E.costume)&&T(E.form)&&E.isFemale===void 0),w)?w:$||D?r.assetForms.find(E=>N(E.costume)&&T(E.form)):null};return l&&u&&(c=L(l,u)),!c&&l&&(c=L(l,null)),!c&&u&&(c=L(null,u)),c||(c=L(null,null)),!c&&b&&!u&&(c=L(l,"FEMALE")),c?.[n]||(e.pokemonDisplay&&e.pokemonDisplay.shiny?s:t)},zt=e=>e.map(t=>{if(t.isEgg||!t.pokemonDisplay)return t;const s=Q(t);return{...t,name:Ht(t.pokemonId,t.pokemonDisplay.formName),sprite:qt(t),typeColors:Yt(s),pokemonClass:s?.pokemonClass,isMaxLevel:t.cpMultiplier+(t.additionalCpMultiplier||0)>.83,specialForm:t.pokemonDisplay.breadModeEnum===1?"Dynamax":t.pokemonDisplay.breadModeEnum===2?"Gigantamax":null}});return es(async()=>{try{const e=await fetch("/api/combat-moves");if(e.ok){K.value=await e.json();const l={};K.value.fastMoves&&K.value.fastMoves.forEach(v=>l[v.move_id]=v),K.value.chargedMoves&&K.value.chargedMoves.forEach(v=>l[v.move_id]=v),B.value=l}else console.error("Failed to load combat moves:",e.status);const t=await fetch("/api/private-data");if(!t.ok)throw new Error((await t.json()).message||"Could not load data.");const s=await t.json();S.value=s.playerData.account||{},p.value=s.playerData.player||{},O.value=s.playerData.items||[];const n=s.playerData.pokemons.filter(l=>!l.isEgg&&l.pokemonId!==0);i.value=s.pokedexService||{typeColorMap:{},pokedex:null},_e.value=s.pvpDataVersion||0,S.value.preferences&&S.value.preferences.avatarId&&(he.value=S.value.preferences.avatarId);const a=await fetch("/data/user/generated/pokedex_client.json");if(a.ok){const l=await a.json(),v={i:"id",f:"formId",d:"dexNr",n:"names",s:"stats",t1:"primaryType",t2:"secondaryType",c:"pokemonClass",a:"assetForms",r:"regionForms",m:"megaEvolutions",as:"assets",e:"English",ty:"type",st:"stamina",at:"attack",de:"defense",im:"image",sh:"shinyImage",co:"costume",fo:"form",if:"isFemale"},c=b=>{if(Array.isArray(b))return b.map(c);if(b!==null&&typeof b=="object"){const L={};for(const D in b){const $=v[D]||D;L[$]=c(b[D])}return L}return b};P.value=c(l);const y=await fetch("/data/user/custom/costumeIdMap.json");if(y.ok&&(q.value=await y.json()),f.value=zt(n),f.value&&f.value.length>0&&R.value){const L=(N=>{let T=0;for(let x=0;x<N.length;x++)T+=N[x].creationTimeMs||0;const w=new Date,E=w.getFullYear(),F=(w.getMonth()+1).toString().padStart(2,"0"),Y=w.getDate().toString().padStart(2,"0"),z=w.getHours().toString().padStart(2,"0");return`pvp_${N.length}_${T}_${E}_${F}_${Y}_${z}_v${_e.value}`})(f.value),D=localStorage.getItem("pvp_cache");let $=!1;if(D)try{const N=JSON.parse(D);if(N.key===L){const T=N.results;f.value.forEach(w=>{T[w.id]&&(w.rankGreat=T[w.id].rankGreat,w.rankUltra=T[w.id].rankUltra,w.rankMaster=T[w.id].rankMaster)}),f.value=[...f.value],$=!0}}catch{localStorage.removeItem("pvp_cache")}if(!$){const N=document.getElementById("pvp-progress-container"),T=document.getElementById("pvp-progress-bar");N&&N.classList.add("active");const w=f.value.map(x=>{const W=Q(x);return{id:x.pokemonId,form:W&&W.formId||"NORMAL",ivs:{atk:x.individualAttack,def:x.individualDefense,sta:x.individualStamina},uniqueId:x.id}}),E=500,F=Math.ceil(w.length/E);let Y={};const z=async x=>{const W=x*E,re=W+E,Be=w.slice(W,re);T&&(T.style.width=`${(x+1)/F*100}%`);const J=await(await fetch("/api/pvp-ranks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pokemons:Be})})).json();if(Object.assign(Y,J),f.value.forEach(H=>{J[H.id]&&(H.rankGreat=J[H.id].rankGreat,H.rankUltra=J[H.id].rankUltra,H.rankMaster=J[H.id].rankMaster)}),f.value=[...f.value],x+1<F)await z(x+1);else{try{localStorage.setItem("pvp_cache",JSON.stringify({key:L,results:Y}))}catch{}setTimeout(()=>{N&&N.classList.remove("active")},1e3)}};z(0).catch(x=>{console.error("PvP Batch Error:",x),N&&N.classList.remove("active")})}}}const r=await fetch("/data/public/type_effectiveness.json");r.ok&&(A.value=await r.json());const m=await fetch("/data/public/raidboss.json");if(m.ok){const l=await m.json(),v=y=>y.map(b=>({...b,typeColors:b.types.map(L=>i.value.typeColorMap[L.toUpperCase()]||"#ccc")})),c=[];for(const y in l.currentList)c.push(...v(l.currentList[y]));de.value=c}const g=await fetch("/data/public/max_battles.json");if(g.ok){const l=await g.json();me.value=l.map(v=>({...v,typeColors:v.types.map(c=>i.value.typeColorMap[c.toUpperCase()]||"#ccc")}))}De(),window.addEventListener("hashchange",De),window.addEventListener("scroll",Oe);const u=document.getElementById("all-pokemon-list");u&&u.addEventListener("scroll",Oe)}catch(e){console.error("Dashboard Error:",e),document.querySelector(".container").innerHTML=`<div class="card"><p>Could not load your player data. Reason: ${e.message}</p></div>`}finally{o.value=!1}}),{isLiteMode:qe,showScrollTop:Te,scrollToTop:Ut,loading:o,account:S,player:p,items:O,activeTab:d,searchQuery:M,sortKey:I,sortDirection:Z,itemsExpanded:G,selectedPokemon:ke,moveMap:B,costumeIdMap:q,pokedexService:i,teamColor:at,xpPercentage:ot,xpProgressText:nt,stardust:rt,pokecoins:lt,highlights:it,groupedItems:ie,itemCategoryOrder:ct,filteredPokemon:pt,totalPokeBalls:ut,totalPotions:dt,totalRevives:mt,toggleSortDirection:$t,getItemSprite:At,createBackgroundStyle:je,getIvPercent:Ne,getCardClass:Ye,getBadges:He,getLevelFromCpm:ss,openPokemonModal:Rt,displayMove:Bt,getIvColor:Ke,getPokemonTypes:Tt,showCleanupModal:ce,openCleanupModal:Ot,closeCleanupModal:Pt,cleanupSearchQuery:ye,groupSubstitutes:ft,defaultCleanupData:vt,formGroupedCleanupData:gt,showTeamBuilderModal:ue,openTeamBuilderModal:St,closeTeamBuilderModal:Lt,selectedRaidBoss:Me,raidBosses:de,maxBattles:me,selectedMaxBoss:be,teamBuilderMode:te,customEnemies:j,activeTeamBuilderTab:pe,allPokedex:P,allPokedexNames:ht,activeTabSuggestions:It,addCustomEnemy:Dt,removeCustomEnemy:xt,customEnemyInput:Ce,battleMode:se,getMoveTypeIconUrl:as,pvpProgress:Gt,combatMoves:K,calculateDps:we,pokedexMode:xe,pokedexDisplayData:Ft,stats_shinyRate:ze,stats_perfectNundo:We,stats_megaEvolvedList:Xe,stats_ivDistribution:Ve,stats_luckyRate:Ze,stats_legendaryRatio:Je,stats_cpDistribution:Qe,stats_captureByYear:et,stats_mostCommon:tt,stats_acquisitionType:st,showTrashModal:Pe,trashConfig:$e,generatedTrashStrings:Ae,generateTrashString:jt,copyToClipboard:Kt,showAvatarModal:fe,visibleAvatars:ve,loadingAvatars:ge,currentAvatarUrl:yt,openAvatarModal:Mt,handleAvatarScroll:bt,selectAvatar:Ct,pendingAvatarId:ne,saveAvatar:Et,savingAvatar:Ee}}}).mount("#app");
